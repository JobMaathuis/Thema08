---
title: "Glucocorticoid receptor dynamica"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Assignment 1

### [1] Why is it best practice to plot the median for the experimental data? Explain in your report

The median is less senstive for possible outliers. If a certain value is very high or very low this does not affect the value of the median. When compared to the mean, for example, this does get affected by an outlier.

### [2] How do the results of the simulations depend on the dose and concentration of the drug? Compare the model variables mRNA, R with the experimental data by running the simulations adjusting dosis D and plot these to find the answer.

```{r}
library(deSolve)

corticosteroid <- function(t, state, paramters) {
  with(as.list(c(state, paramters)),{
    dmRNAr <- ks.Rm * (1 - DR.N / (IC50.Rm + DR.N)) - k.dRm * mRNAr
    
    dR <- k.sR * mRNAr + Rf * k.re * DR.N - k.on * D * R - k.dR * R
    
    dDR <- k.on * D * R - k.T * DR
    
    dDR.N <- k.T * DR - k.re * DR.N
    
    list(c(dmRNAr, dR, dDR, dDR.N))
  }) 
}

parameters <- c(ks.Rm = 2.90,
                IC50.Rm = 26.2,
                k.on = 0.00329,
                k.T = 0.63,
                k.re = 0.57,
                Rf = 0.49,
                k.dR = 0.0572,
                k.dRm = 0.612,
                k.sR = 3.22,
                D = 20 * 1000 * 1/374.471 )

state <- c(mRNAr = 4.74,
           R = 267,
           DR = 0,
           DR.N = 0)

times <- seq(0, 48)

out.normal <- ode(y = state, times = times, func = corticosteroid, parms = parameters)

parameters['D'] <- 80 * 1000 * 1/374.471 
out.high <- ode(y = state, times = times, func = corticosteroid, parms = parameters)

parameters['D'] <- 1 * 1000 * 1/374.471 
out.low <- ode(y = state, times = times, func = corticosteroid, parms = parameters)

plot(out.normal[,1], out.normal[,2], las = 1, main = "mRNAr", ylim = c(0, 5), type = "l",
     xlab = "time (h)", ylab = "receptor mRNA")
lines(out.high[,2], col = "red")
lines(out.low[,2], col = "green")
legend(x = 35, y = 2, legend = c("low dosis", "normal dosis", "high dosis"), fill = c("green", "black", "red"))

plot(out.normal[,1], out.normal[,3], las = 1, main = "R", ylim = c(0, 275), type = "l",
     xlab = "time (h)", ylab = "free receptor density ")
lines(out.high[,3], col = "red")
lines(out.low[,3], col = "green")
legend(x = 35, y = 200, legend = c("low dosis", "normal dosis", "high dosis"), fill = c("green", "black", "red"))
```


mRNAr: The concentration of mRNAr is influenced by the MPL concentration. When a lower MPL concentration is used the mRNAr is decreasing slower. The DR(N) affects the mRNAr synthesis, this DR(N) concentration is lower when there is less MPL and therefore the mRNAr does not decrease as much. When a higher dosis is used the mRNAr is decreasing more rapidly and a lower end concentration at equilibrium can be seen. This is becuase the medicine can bind to more receptors, which results in more DR and therefore more DR(N). The IC50 value is reached earlier and the mRNAr concentration gets decreased.


R: The R concentration decreases less when using a lower MPL concentration. This is due to the fact that there is less MPL to create a MPL-receptor complex, so the R concentration stays high. The opposite can be seen when using a higher MPL concentration. The receptor concentration decreases very fast and has a lower end concentration. This is because there is more medicine to bind to the receptor, resulting in a lower receptor concentration.


### [3] Are the results of the model in line with experimental data? If not, what could be the reason? Think of at least one explanation. Try to test it with simulations (you will get bonus points for that, your explanation does not need to be correct, but should be logical).

```{r}
MPL <- read.csv("MPL.csv")
```

```{r}
parameters['D'] <- 14.59 * 1000 * 1/374.471 
out <- ode(y = state, times = times, func = corticosteroid, parms = parameters)

plot(MPL$mRNA[MPL$dose == 0.1] ~ MPL$time[MPL$dose == 0.1],
     xlab = "time", ylab = "mRNAr concentration")

medians <- aggregate(MPL[,c("MPL_conc","mRNA","Free_receptor")],list(MPL$dose,MPL$time), median, na.rm=T)
names(medians)[1:2] <- c("dose","time")
points(medians$mRNA[MPL$dose == 0.1] ~ medians$time[MPL$dose == 0.1], col = "red")
```
















